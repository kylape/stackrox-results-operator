# Example ImageVulnerability CRD (Individual Mode)
# This is what the operator creates when exporting image vulnerabilities in individual mode
# Created by the operator - users do not create these directly

apiVersion: results.stackrox.io/v1alpha1
kind: ImageVulnerability
metadata:
  # Name based on image SHA
  name: nginx-1-25-3-sha256-abc123def456
  labels:
    stackrox.io/image-name: nginx
    stackrox.io/image-tag: "1.25.3"
    stackrox.io/registry: docker.io
    stackrox.io/has-critical: "true"
    stackrox.io/has-fixable: "true"
  annotations:
    stackrox.io/central-url: "https://central.stackrox.svc/main/vulnerability-management/image/sha256:abc123def456"
spec:
  # Image reference
  image:
    fullName: "docker.io/library/nginx:1.25.3"
    name: "nginx"
    tag: "1.25.3"
    registry: "docker.io"
    remote: "library/nginx"
    sha: "sha256:abc123def456789012345678901234567890123456789012345678901234"

  # When the image was scanned
  scanTime: "2025-11-04T10:00:00Z"

  # Summary of vulnerabilities by severity
  summary:
    total: 45
    fixableTotal: 15
    critical:
      total: 3
      fixable: 2
    high:
      total: 12
      fixable: 8
    medium:
      total: 20
      fixable: 5
    low:
      total: 10
      fixable: 0

  # Top CVEs (limited to maxCVEsPerResource)
  cves:
    - cve: "CVE-2024-1234"
      severity: CRITICAL
      cvss: "9.8"
      cvssV3:
        score: "9.8"
        vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
      component:
        name: "libssl"
        version: "3.0.10-1"
        location: "/usr/lib/x86_64-linux-gnu/libssl.so.3"
      summary: "Critical vulnerability in OpenSSL allowing remote code execution"
      link: "https://nvd.nist.gov/vuln/detail/CVE-2024-1234"
      published: "2024-10-15T08:00:00Z"
      discoveredInImage: "2025-11-04T10:00:00Z"
      fixable: true
      fixedBy: "3.0.12-1"
      state: OBSERVED
      epss:
        score: "0.95"
        percentile: "0.99"

    - cve: "CVE-2024-5678"
      severity: CRITICAL
      cvss: "8.8"
      cvssV3:
        score: "8.8"
        vector: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
      component:
        name: "curl"
        version: "8.2.1-1"
        location: "/usr/bin/curl"
      summary: "Authentication bypass in curl library"
      link: "https://nvd.nist.gov/vuln/detail/CVE-2024-5678"
      published: "2024-09-20T12:00:00Z"
      discoveredInImage: "2025-11-04T10:00:00Z"
      fixable: true
      fixedBy: "8.5.0-1"
      state: OBSERVED

    - cve: "CVE-2023-9999"
      severity: CRITICAL
      cvss: "7.5"
      component:
        name: "zlib"
        version: "1.2.11-1"
      summary: "Buffer overflow in zlib compression library"
      link: "https://nvd.nist.gov/vuln/detail/CVE-2023-9999"
      published: "2023-12-01T00:00:00Z"
      discoveredInImage: "2025-11-04T10:00:00Z"
      fixable: false
      state: OBSERVED
